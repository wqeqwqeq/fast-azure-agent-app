# HR Assistant Example

Complete example of an HR Assistant configuration created by `/onboard`.

## Domain Configuration

- **Domain Name**: HR Assistant
- **Description**: Helps employees manage leave, check payroll, and access benefits information

## Sub-Agents

### 1. Leave Agent

| Field | Value |
|-------|-------|
| **Key** | `leave` |
| **Name** | leave-agent |
| **Description** | Handles vacation and leave requests |
| **Capabilities** | Check leave balance, Submit leave requests, Cancel leave requests |

**Tools:**
- `get_leave_balance(employee_id: str)` - Get remaining PTO/vacation days
- `submit_leave_request(employee_id: str, start_date: str, end_date: str, leave_type: str)` - Submit a new leave request
- `cancel_leave_request(request_id: str)` - Cancel a pending leave request

**Routing:**
- Route here when: PTO, vacation, sick leave, time off requests, leave balance
- Do NOT route here when: Questions about PAY during leave (-> payroll)

---

### 2. Payroll Agent

| Field | Value |
|-------|-------|
| **Key** | `payroll` |
| **Name** | payroll-agent |
| **Description** | Handles salary and compensation queries |
| **Capabilities** | View pay stubs, Check bonus info, Salary information |

**Tools:**
- `get_pay_stub(employee_id: str, pay_period: str)` - Retrieve pay stub for a period
- `get_bonus_info(employee_id: str, year: int)` - Get bonus information for a year

**Routing:**
- Route here when: Salary, pay, compensation, bonus questions, pay during leave
- Do NOT route here when: Leave balance (-> leave agent)

---

## Generated Files

### 1. `app/agent_factory/agents/sub_agents/leave_agent.py`

```python
"""Leave Agent - Handles vacation and leave requests.

Generated by /onboard skill.
"""

from dataclasses import dataclass
from typing import Optional

from ...factory import create_agent
from ...model_registry import ModelRegistry
from .tools.leave_tools import (
    get_leave_balance,
    submit_leave_request,
    cancel_leave_request,
)


@dataclass(frozen=True)
class LeaveAgentConfig:
    """Configuration for the Leave agent."""

    name: str = "leave-agent"
    description: str = "Handles vacation and leave requests"
    instructions: str = """You are a leave management assistant that helps employees with time-off requests.

## Your Capabilities
- Check remaining PTO/vacation/sick days
- Submit new leave requests
- Cancel pending leave requests

## Available Tools
- **get_leave_balance**: Check how many days off an employee has remaining
- **submit_leave_request**: Submit a new time-off request (vacation, sick, personal)
- **cancel_leave_request**: Cancel a pending leave request by ID

## Guidelines
- Always verify the employee_id before making requests
- Confirm dates and leave type before submitting
- If cancellation fails, explain why

## Output Format
Always format your response in Markdown:
- Use **bold** for balances and important numbers
- Use bullet points for listing multiple leave types
- Use `code` formatting for request IDs
"""


CONFIG = LeaveAgentConfig()


def create_leave_agent(
    registry: Optional[ModelRegistry] = None,
    model_name: Optional[str] = None,
):
    """Create and return the Leave agent."""
    return create_agent(
        name=CONFIG.name,
        description=CONFIG.description,
        instructions=CONFIG.instructions,
        registry=registry,
        model_name=model_name,
        tools=[get_leave_balance, submit_leave_request, cancel_leave_request],
    )
```

### 2. `app/agent_factory/agents/sub_agents/tools/leave_tools.py`

```python
"""Tool functions for Leave Agent.

Generated by /onboard skill.
"""

import json
from datetime import datetime
from typing import Annotated


def get_leave_balance(
    employee_id: Annotated[str, "Employee ID to check balance for"],
) -> str:
    """Get remaining PTO/vacation days for an employee."""
    # TODO: Replace with actual HR system API call
    return json.dumps(
        {
            "employee_id": employee_id,
            "vacation_days": 15,
            "sick_days": 5,
            "personal_days": 2,
            "checked_at": datetime.utcnow().isoformat() + "Z",
        },
        indent=2,
    )


def submit_leave_request(
    employee_id: Annotated[str, "Employee ID"],
    start_date: Annotated[str, "Start date (YYYY-MM-DD)"],
    end_date: Annotated[str, "End date (YYYY-MM-DD)"],
    leave_type: Annotated[str, "Type: 'vacation', 'sick', 'personal'"] = "vacation",
) -> str:
    """Submit a new leave request for an employee."""
    # TODO: Replace with actual HR system API call
    return json.dumps(
        {
            "status": "submitted",
            "request_id": "REQ-12345",
            "employee_id": employee_id,
            "start_date": start_date,
            "end_date": end_date,
            "leave_type": leave_type,
            "submitted_at": datetime.utcnow().isoformat() + "Z",
        },
        indent=2,
    )


def cancel_leave_request(
    request_id: Annotated[str, "Leave request ID to cancel"],
) -> str:
    """Cancel a pending leave request."""
    # TODO: Replace with actual HR system API call
    return json.dumps(
        {
            "status": "cancelled",
            "request_id": request_id,
            "cancelled_at": datetime.utcnow().isoformat() + "Z",
        },
        indent=2,
    )
```

### 3. `app/agent_factory/subagent_config.py`

```python
"""Sub-Agent Configuration for Agent Factory.

Generated by /onboard skill.
"""

from .schemas.config import SubAgentConfig, ToolConfig, ToolParameterConfig, UseCaseConfig

DOMAIN_NAME = "HR Assistant"
DOMAIN_DESCRIPTION = "Helps employees manage leave, check payroll, and access benefits information"

SUB_AGENTS: list[SubAgentConfig] = [
    SubAgentConfig(
        key="leave",
        name="leave-agent",
        description="Handles vacation and leave requests",
        capabilities=[
            "Check leave balance",
            "Submit leave requests",
            "Cancel leave requests",
        ],
        tools=[
            ToolConfig(
                name="get_leave_balance",
                description="Get remaining PTO/vacation days",
                parameters=[
                    ToolParameterConfig(name="employee_id", type="str", description="Employee ID", required=True),
                ],
            ),
            ToolConfig(
                name="submit_leave_request",
                description="Submit a new leave request",
                parameters=[
                    ToolParameterConfig(name="employee_id", type="str", description="Employee ID", required=True),
                    ToolParameterConfig(name="start_date", type="str", description="Start date (YYYY-MM-DD)", required=True),
                    ToolParameterConfig(name="end_date", type="str", description="End date (YYYY-MM-DD)", required=True),
                    ToolParameterConfig(name="leave_type", type="str", description="vacation/sick/personal", required=False),
                ],
            ),
            ToolConfig(
                name="cancel_leave_request",
                description="Cancel a pending leave request",
                parameters=[
                    ToolParameterConfig(name="request_id", type="str", description="Leave request ID", required=True),
                ],
            ),
        ],
        use_cases=[
            UseCaseConfig(intent="Check balance", example_queries=["How many vacation days do I have?", "What's my PTO balance?"]),
            UseCaseConfig(intent="Request leave", example_queries=["I need time off next week", "Book March 15-22 off"]),
            UseCaseConfig(intent="Cancel leave", example_queries=["Cancel my upcoming vacation"]),
        ],
        when_to_use=["PTO questions", "vacation requests", "sick leave", "time off requests"],
        when_not_to_use=["Questions about PAY during leave (route to payroll)"],
    ),
    SubAgentConfig(
        key="payroll",
        name="payroll-agent",
        description="Handles salary and compensation queries",
        capabilities=[
            "View pay stubs",
            "Check bonus info",
            "Salary information",
        ],
        tools=[
            ToolConfig(
                name="get_pay_stub",
                description="Retrieve pay stub for a specific period",
                parameters=[
                    ToolParameterConfig(name="employee_id", type="str", description="Employee ID", required=True),
                    ToolParameterConfig(name="pay_period", type="str", description="Pay period (YYYY-MM)", required=True),
                ],
            ),
            ToolConfig(
                name="get_bonus_info",
                description="Get bonus information for a year",
                parameters=[
                    ToolParameterConfig(name="employee_id", type="str", description="Employee ID", required=True),
                    ToolParameterConfig(name="year", type="int", description="Year to query", required=True),
                ],
            ),
        ],
        use_cases=[
            UseCaseConfig(intent="Pay stub", example_queries=["Show my last paycheck", "When do I get paid?"]),
            UseCaseConfig(intent="Bonus", example_queries=["What's my bonus this quarter?"]),
        ],
        when_to_use=["salary questions", "pay inquiries", "compensation", "bonus questions"],
        when_not_to_use=["Leave balance (route to leave agent)"],
    ),
]
```

### 4. Modified Triage Agent Prompt (excerpt)

In `app/agent_factory/agents/orchestration/triage_agent.py`, the placeholders are filled:

```python
instructions: str = """You are a triage agent for HR Assistant that helps employees manage leave, check payroll, and access benefits information.

## Specialized Agents Available

### leave (Leave Management Agent)
Handles employee leave requests, PTO balances, and time-off submissions.
- **Tools**: get_leave_balance, submit_leave_request, cancel_leave_request
- **Use for**: "How many vacation days?", "Request time off", "Cancel my leave"
- **Do NOT use for**: Pay during leave (-> payroll)

### payroll (Payroll Agent)
Handles salary, compensation, and payment queries.
- **Tools**: get_pay_stub, get_bonus_info
- **Use for**: "Show my pay stub", "When is payday?", "Bonus information"
- **Do NOT use for**: Leave balance (-> leave)

## Routing Examples
- "How many vacation days do I have?" -> leave agent
- "Show me my last pay stub" -> payroll agent
- "Will I get paid during my vacation?" -> payroll (money-focused)
- "Request March 15-22 off" -> leave agent
- "What's my bonus?" -> payroll agent

## Decision Guidelines
- For ambiguous queries about "time off pay", route to payroll (money-focused)
- For balance checks, always route to leave agent
- If unclear, ask a clarifying question
"""
```

---

## Testing

After generation, test with:

```bash
USE_DEMO_OPSAGENT=false uv run uvicorn app.main:app --reload
```

Sample test queries:
1. "How many vacation days do I have?" -> Should route to leave agent
2. "Show me my last paycheck" -> Should route to payroll agent
3. "Will I get paid during my vacation?" -> Should route to payroll (ambiguous case)
